/*! quartz - v
 *  Release on: 2015-03-11
 *  Copyright (c) 2015 Cory Mawhorter
 *  Licensed MIT */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(){Array.isArray||(Array.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)})},{}],2:[function(a){(function(b){"use strict";function c(a){a=a||{},this.options=a,this.options.defaultStatusCode=this.options.defaultStatusCode||200,this.options.parseQuerystring=this.options.parseQuerystring||function(a){var b={};if(a.indexOf("?")>0)for(var c=a.substr(a.indexOf("?")+1).split(/&amp;|&/i),d=0;d<c.length;d++){var e=c[d],f=e.split("=",2),g=f[0],h=decodeURIComponent(f[1].replace(/\+/g,"%20"));b[g]=b[g.toLowerCase()]=h}return b},this._server=null,this._handlers=[],this._started=!1,this.logger=new d("debug"in this.options?this.options.debug:-1,"Quartz: ")}function d(a,b){this.logLevel=a,this.prefix=b}c.prototype.listen=function(){this.logger.debug("Starting quartz server with options:",this.options);var b=this,c=a("sinon");return this._server=c.fakeServer.create(),this._server.autoRespond=!0,this._server.autoRespondAfter="latency"in this.options?this.options.latency:10,this._server.xhr.useFilters=!0,this._server.xhr.addFilter(function(a,c){return!b.handlerExists(c,a)}),this.options.onCreate&&(this._server.xhr.onCreate=this.options.onCreate),this._started=!0,this._handlers.length&&this._reattachHandlers(),this.logger.info("Quartz started"),this},c.prototype.start=c.prototype.listen,c.prototype.init=c.prototype.listen,c.prototype._reattachHandlers=function(){this.logger.debug("Reattaching handlers",this._handlers);for(var a=0;a<this._handlers.length;a++){var b=this._handlers[a];this._responder.apply(this,b)}},c.prototype._responder=function(a,b,c){var d=this;this._server.respondWith(a,b,function(e){return d.logger.log("Response handler",a,b),d._response(e),c.apply(this,arguments)})},c.prototype._response=function(a){var b=this,c=this.options.defaultStatusCode,d=function(b){for(var c in a.requestHeaders)if(c.toLowerCase()===b)return c;return null},e={get:function(a){var b=d(a);return b?this.requestHeaders[b]:null},set:function(a,b){var c={};1===arguments.length?c=a:c[a]=b;for(var e in c){var f=d(e);this.requestHeaders[f||e]=c[e]}},contentType:function(a){return this.set("content-type",a),this},status:function(a){return c=a,this},json:function(a){return this.contentType("application/json").send(JSON.stringify(a))},send:function(a){return void 0===a||"string"==typeof a?(b.logger.log("Sending response",c,this.requestHeaders),b.logger.debug("Response data",a),this.respond(c,this.requestHeaders,a)):this.json(a),this},end:function(){return this.send()}};a.query=this.options.parseQuerystring(a.url)||{};for(var f in e)a[f]=e[f].bind(a)},c.prototype.handlerExists=function(a,b){for(var c=0;c<this._handlers.length;c++){var d=this._handlers[c],e=d[1]instanceof RegExp?d[1].test(a):a===d[1],f=null===d[0]||!b||d[0]===b;if(e&&f)return!0}return!1},c.prototype.all=function(a,b){return this.on(null,a,b)},c.prototype.opts=function(a,b){return this.on("OPTIONS",a,b)},c.prototype.head=function(a,b){return this.on("HEAD",a,b)},c.prototype.get=function(a,b){return this.on("GET",a,b)},c.prototype.post=function(a,b){return this.on("POST",a,b)},c.prototype.put=function(a,b){return this.on("PUT",a,b)},c.prototype.del=function(a,b){return this.on("DELETE",a,b)},c.prototype.on=function(a,b,c){return"string"==typeof a&&(a=a.toUpperCase()),this._handlers.push(arguments),!0===this._started&&this._responder(a,b,c),this},c.prototype.close=function(){return this._server.restore(),this._started=!1,this.logger.info("Quartz stopped"),this},c.prototype.stop=c.prototype.close,c.prototype.shutdown=c.prototype.close,d.prototype._log=function(a,b,c){this.logLevel>=a&&(c=Array.prototype.slice.call(c),this.prefix&&c.unshift(this.prefix),console[b].apply(console,c))},d.prototype.debug=function(){this._log(3,"debug",arguments)},d.prototype.log=function(){this._log(2,"log",arguments)},d.prototype.info=function(){this._log(1,"info",arguments)},d.prototype.warn=function(){this._log(0,"warn",arguments)},d.prototype.error=function(){this._log(-1,"error",arguments)},c.Logger=d,b.Quartz=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{sinon:7}],3:[function(a,b){b.exports="function"==typeof Object.create?function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],4:[function(a,b){function c(){if(!g){g=!0;for(var a,b=f.length;b;){a=f,f=[];for(var c=-1;++c<b;)a[c]();b=f.length}g=!1}}function d(){}var e=b.exports={},f=[],g=!1;e.nextTick=function(a){f.push(a),g||setTimeout(c,0)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=d,e.addListener=d,e.once=d,e.off=d,e.removeListener=d,e.removeAllListeners=d,e.emit=d,e.binding=function(){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},{}],5:[function(a,b){b.exports=function(a){return a&&"object"==typeof a&&"function"==typeof a.copy&&"function"==typeof a.fill&&"function"==typeof a.readUInt8}},{}],6:[function(a,b,c){(function(b,d){function e(a,b){var d={seen:[],stylize:g};return arguments.length>=3&&(d.depth=arguments[2]),arguments.length>=4&&(d.colors=arguments[3]),p(b)?d.showHidden=b:b&&c._extend(d,b),v(d.showHidden)&&(d.showHidden=!1),v(d.depth)&&(d.depth=2),v(d.colors)&&(d.colors=!1),v(d.customInspect)&&(d.customInspect=!0),d.colors&&(d.stylize=f),i(d,a,d.depth)}function f(a,b){var c=e.styles[b];return c?"["+e.colors[c][0]+"m"+a+"["+e.colors[c][1]+"m":a}function g(a){return a}function h(a){var b={};return a.forEach(function(a){b[a]=!0}),b}function i(a,b,d){if(a.customInspect&&b&&A(b.inspect)&&b.inspect!==c.inspect&&(!b.constructor||b.constructor.prototype!==b)){var e=b.inspect(d,a);return t(e)||(e=i(a,e,d)),e}var f=j(a,b);if(f)return f;var g=Object.keys(b),p=h(g);if(a.showHidden&&(g=Object.getOwnPropertyNames(b)),z(b)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return k(b);if(0===g.length){if(A(b)){var q=b.name?": "+b.name:"";return a.stylize("[Function"+q+"]","special")}if(w(b))return a.stylize(RegExp.prototype.toString.call(b),"regexp");if(y(b))return a.stylize(Date.prototype.toString.call(b),"date");if(z(b))return k(b)}var r="",s=!1,u=["{","}"];if(o(b)&&(s=!0,u=["[","]"]),A(b)){var v=b.name?": "+b.name:"";r=" [Function"+v+"]"}if(w(b)&&(r=" "+RegExp.prototype.toString.call(b)),y(b)&&(r=" "+Date.prototype.toUTCString.call(b)),z(b)&&(r=" "+k(b)),0===g.length&&(!s||0==b.length))return u[0]+r+u[1];if(0>d)return w(b)?a.stylize(RegExp.prototype.toString.call(b),"regexp"):a.stylize("[Object]","special");a.seen.push(b);var x;return x=s?l(a,b,d,p,g):g.map(function(c){return m(a,b,d,p,c,s)}),a.seen.pop(),n(x,r,u)}function j(a,b){if(v(b))return a.stylize("undefined","undefined");if(t(b)){var c="'"+JSON.stringify(b).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return a.stylize(c,"string")}return s(b)?a.stylize(""+b,"number"):p(b)?a.stylize(""+b,"boolean"):q(b)?a.stylize("null","null"):void 0}function k(a){return"["+Error.prototype.toString.call(a)+"]"}function l(a,b,c,d,e){for(var f=[],g=0,h=b.length;h>g;++g)f.push(F(b,String(g))?m(a,b,c,d,String(g),!0):"");return e.forEach(function(e){e.match(/^\d+$/)||f.push(m(a,b,c,d,e,!0))}),f}function m(a,b,c,d,e,f){var g,h,j;if(j=Object.getOwnPropertyDescriptor(b,e)||{value:b[e]},j.get?h=j.set?a.stylize("[Getter/Setter]","special"):a.stylize("[Getter]","special"):j.set&&(h=a.stylize("[Setter]","special")),F(d,e)||(g="["+e+"]"),h||(a.seen.indexOf(j.value)<0?(h=q(c)?i(a,j.value,null):i(a,j.value,c-1),h.indexOf("\n")>-1&&(h=f?h.split("\n").map(function(a){return"  "+a}).join("\n").substr(2):"\n"+h.split("\n").map(function(a){return"   "+a}).join("\n"))):h=a.stylize("[Circular]","special")),v(g)){if(f&&e.match(/^\d+$/))return h;g=JSON.stringify(""+e),g.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(g=g.substr(1,g.length-2),g=a.stylize(g,"name")):(g=g.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),g=a.stylize(g,"string"))}return g+": "+h}function n(a,b,c){var d=0,e=a.reduce(function(a,b){return d++,b.indexOf("\n")>=0&&d++,a+b.replace(/\u001b\[\d\d?m/g,"").length+1},0);return e>60?c[0]+(""===b?"":b+"\n ")+" "+a.join(",\n  ")+" "+c[1]:c[0]+b+" "+a.join(", ")+" "+c[1]}function o(a){return Array.isArray(a)}function p(a){return"boolean"==typeof a}function q(a){return null===a}function r(a){return null==a}function s(a){return"number"==typeof a}function t(a){return"string"==typeof a}function u(a){return"symbol"==typeof a}function v(a){return void 0===a}function w(a){return x(a)&&"[object RegExp]"===C(a)}function x(a){return"object"==typeof a&&null!==a}function y(a){return x(a)&&"[object Date]"===C(a)}function z(a){return x(a)&&("[object Error]"===C(a)||a instanceof Error)}function A(a){return"function"==typeof a}function B(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function C(a){return Object.prototype.toString.call(a)}function D(a){return 10>a?"0"+a.toString(10):a.toString(10)}function E(){var a=new Date,b=[D(a.getHours()),D(a.getMinutes()),D(a.getSeconds())].join(":");return[a.getDate(),J[a.getMonth()],b].join(" ")}function F(a,b){return Object.prototype.hasOwnProperty.call(a,b)}var G=/%[sdj%]/g;c.format=function(a){if(!t(a)){for(var b=[],c=0;c<arguments.length;c++)b.push(e(arguments[c]));return b.join(" ")}for(var c=1,d=arguments,f=d.length,g=String(a).replace(G,function(a){if("%%"===a)return"%";if(c>=f)return a;switch(a){case"%s":return String(d[c++]);case"%d":return Number(d[c++]);case"%j":try{return JSON.stringify(d[c++])}catch(b){return"[Circular]"}default:return a}}),h=d[c];f>c;h=d[++c])g+=q(h)||!x(h)?" "+h:" "+e(h);return g},c.deprecate=function(a,e){function f(){if(!g){if(b.throwDeprecation)throw new Error(e);b.traceDeprecation?console.trace(e):console.error(e),g=!0}return a.apply(this,arguments)}if(v(d.process))return function(){return c.deprecate(a,e).apply(this,arguments)};if(b.noDeprecation===!0)return a;var g=!1;return f};var H,I={};c.debuglog=function(a){if(v(H)&&(H=b.env.NODE_DEBUG||""),a=a.toUpperCase(),!I[a])if(new RegExp("\\b"+a+"\\b","i").test(H)){var d=b.pid;I[a]=function(){var b=c.format.apply(c,arguments);console.error("%s %d: %s",a,d,b)}}else I[a]=function(){};return I[a]},c.inspect=e,e.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},e.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},c.isArray=o,c.isBoolean=p,c.isNull=q,c.isNullOrUndefined=r,c.isNumber=s,c.isString=t,c.isSymbol=u,c.isUndefined=v,c.isRegExp=w,c.isObject=x,c.isDate=y,c.isError=z,c.isFunction=A,c.isPrimitive=B,c.isBuffer=a("./support/isBuffer");var J=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];c.log=function(){console.log("%s - %s",E(),c.format.apply(c,arguments))},c.inherits=a("inherits"),c._extend=function(a,b){if(!b||!x(b))return a;for(var c=Object.keys(b),d=c.length;d--;)a[c[d]]=b[c[d]];return a}}).call(this,a("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":5,_process:4,inherits:3}],7:[function(a,b){"use strict";!function(){function c(a,b,c){d=c.exports=a("./sinon/util/core"),a("./sinon/extend"),a("./sinon/typeOf"),a("./sinon/times_in_words"),a("./sinon/spy"),a("./sinon/call"),a("./sinon/behavior"),a("./sinon/stub"),a("./sinon/mock"),a("./sinon/collection"),a("./sinon/assert"),a("./sinon/sandbox"),a("./sinon/test"),a("./sinon/test_case"),a("./sinon/match"),a("./sinon/format"),a("./sinon/log_error")}var d,e="undefined"!=typeof b&&b.exports&&"function"==typeof a,f="function"==typeof define&&"object"==typeof define.amd&&define.amd;return f?define(c):e?(c(a,b.exports,b),d=b.exports):d={},d}()},{"./sinon/assert":8,"./sinon/behavior":9,"./sinon/call":10,"./sinon/collection":11,"./sinon/extend":12,"./sinon/format":13,"./sinon/log_error":14,"./sinon/match":15,"./sinon/mock":16,"./sinon/sandbox":17,"./sinon/spy":18,"./sinon/stub":19,"./sinon/test":20,"./sinon/test_case":21,"./sinon/times_in_words":22,"./sinon/typeOf":23,"./sinon/util/core":24}],8:[function(a,b){(function(c){"use strict";!function(c,d){function e(a){function b(){for(var a,c=0,d=arguments.length;d>c;++c)a=arguments[c],a||h.fail("fake is not a spy"),a.proxy?b(a.proxy):("function"!=typeof a&&h.fail(a+" is not a function"),"function"!=typeof a.getCall&&h.fail(a+" is not stubbed"))}function c(a,b){a=a||d;var c=a.fail||h.fail;c.call(a,b)}function e(a,d,e){2==arguments.length&&(e=d,d=a),h[a]=function(f){b(f);var i=g.call(arguments,1),j=!1;j="function"==typeof d?!d(f):"function"==typeof f[d]?!f[d].apply(f,i):!f[d],j?c(this,(f.printf||f.proxy.printf).apply(f,[e].concat(i))):h.pass(a)}}function f(a,b){return!a||/^fail/.test(b)?b:a+b.slice(0,1).toUpperCase()+b.slice(1)}var h;return h={failException:"AssertError",fail:function(a){var b=new Error(a);throw b.name=this.failException||h.failException,b},pass:function(){},callOrder:function(){b.apply(null,arguments);var d="",e="";if(a.calledInOrder(arguments))h.pass("callOrder");else{try{d=[].join.call(arguments,", ");for(var f=g.call(arguments),i=f.length;i;)f[--i].called||f.splice(i,1);e=a.orderByFirstCall(f).join(", ")}catch(j){}c(this,"expected "+d+" to be called in order but were called as "+e)}},callCount:function(d,e){if(b(d),d.callCount!=e){var f="expected %n to be called "+a.timesInWords(e)+" but was called %c%C";c(this,d.printf(f))}else h.pass("callCount")},expose:function(a,b){if(!a)throw new TypeError("target is null or undefined");var c=b||{},d="undefined"==typeof c.prefix&&"assert"||c.prefix,e="undefined"==typeof c.includeFail||!!c.includeFail;for(var g in this)"expose"==g||!e&&/^(fail)/.test(g)||(a[f(d,g)]=this[g]);return a},match:function(b,d){var e=a.match(d);if(e.test(b))h.pass("match");else{var f=["expected value to match","    expected = "+a.format(d),"    actual = "+a.format(b)];c(this,f.join("\n"))}}},e("called","expected %n to have been called at least once but was never called"),e("notCalled",function(a){return!a.called},"expected %n to not have been called but was called %c%C"),e("calledOnce","expected %n to be called once but was called %c%C"),e("calledTwice","expected %n to be called twice but was called %c%C"),e("calledThrice","expected %n to be called thrice but was called %c%C"),e("calledOn","expected %n to be called with %1 as this but was called with %t"),e("alwaysCalledOn","expected %n to always be called with %1 as this but was called with %t"),e("calledWithNew","expected %n to be called with new"),e("alwaysCalledWithNew","expected %n to always be called with new"),e("calledWith","expected %n to be called with arguments %*%C"),e("calledWithMatch","expected %n to be called with match %*%C"),e("alwaysCalledWith","expected %n to always be called with arguments %*%C"),e("alwaysCalledWithMatch","expected %n to always be called with match %*%C"),e("calledWithExactly","expected %n to be called with exact arguments %*%C"),e("alwaysCalledWithExactly","expected %n to always be called with exact arguments %*%C"),e("neverCalledWith","expected %n to never be called with arguments %*%C"),e("neverCalledWithMatch","expected %n to never be called with match %*%C"),e("threw","%n did not throw exception%C"),e("alwaysThrew","%n did not always throw exception%C"),a.assert=h,h}function f(a,b,c){var d=a("./util/core");a("./match"),a("./format"),c.exports=e(d)}var g=Array.prototype.slice,h="undefined"!=typeof b&&b.exports&&"function"==typeof a,i="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(i)define(f);else if(h)f(a,b.exports,b);else{if(!c)return;e(c)}}("object"==typeof sinon&&sinon||null,"undefined"!=typeof window?window:"undefined"!=typeof self?self:c)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./format":13,"./match":15,"./util/core":24}],9:[function(a,b){(function(c){"use strict";!function(d){function e(a,b){return"string"==typeof a?(this.exception=new Error(b||""),this.exception.name=a):this.exception=a?a:new Error("Error"),this}function f(a,b){var c=a.callArgAt;if(c>=0)return b[c];var d;c===k&&(d=b),c===l&&(d=i.call(b).reverse());for(var e=a.callArgProp,f=0,g=d.length;g>f;++f){if(!e&&"function"==typeof d[f])return d[f];if(e&&d[f]&&"function"==typeof d[f][e])return d[f][e]}return null}function g(a){function b(b,c,d){if(b.callArgAt<0){var e;return e=b.callArgProp?a.functionName(b.stub)+" expected to yield to '"+b.callArgProp+"', but no object with such a property was passed.":a.functionName(b.stub)+" expected to yield, but no callback was passed.",d.length>0&&(e+=" Received ["+j.call(d,", ")+"]"),e}return"argument at index "+b.callArgAt+" is not a function: "+c}function c(a,c){if("number"==typeof a.callArgAt){var d=f(a,c);if("function"!=typeof d)throw new TypeError(b(a,d,c));a.callbackAsync?m(function(){d.apply(a.callbackContext,a.callbackArguments)}):d.apply(a.callbackContext,a.callbackArguments)}}var d={create:function(b){var c=a.extend({},a.behavior);return delete c.create,c.stub=b,c},isPresent:function(){return"number"==typeof this.callArgAt||this.exception||"number"==typeof this.returnArgAt||this.returnThis||this.returnValueDefined},invoke:function(a,b){if(c(this,b),this.exception)throw this.exception;return"number"==typeof this.returnArgAt?b[this.returnArgAt]:this.returnThis?a:this.returnValue},onCall:function(a){return this.stub.onCall(a)},onFirstCall:function(){return this.stub.onFirstCall()},onSecondCall:function(){return this.stub.onSecondCall()},onThirdCall:function(){return this.stub.onThirdCall()},withArgs:function(){throw new Error('Defining a stub by invoking "stub.onCall(...).withArgs(...)" is not supported. Use "stub.withArgs(...).onCall(...)" to define sequential behavior for calls with certain arguments.')},callsArg:function(a){if("number"!=typeof a)throw new TypeError("argument index is not number");return this.callArgAt=a,this.callbackArguments=[],this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgOn:function(a,b){if("number"!=typeof a)throw new TypeError("argument index is not number");if("object"!=typeof b)throw new TypeError("argument context is not an object");return this.callArgAt=a,this.callbackArguments=[],this.callbackContext=b,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgWith:function(a){if("number"!=typeof a)throw new TypeError("argument index is not number");return this.callArgAt=a,this.callbackArguments=i.call(arguments,1),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},callsArgOnWith:function(a,b){if("number"!=typeof a)throw new TypeError("argument index is not number");if("object"!=typeof b)throw new TypeError("argument context is not an object");return this.callArgAt=a,this.callbackArguments=i.call(arguments,2),this.callbackContext=b,this.callArgProp=void 0,this.callbackAsync=!1,this},yields:function(){return this.callArgAt=k,this.callbackArguments=i.call(arguments,0),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsRight:function(){return this.callArgAt=l,this.callbackArguments=i.call(arguments,0),this.callbackContext=void 0,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsOn:function(a){if("object"!=typeof a)throw new TypeError("argument context is not an object");return this.callArgAt=k,this.callbackArguments=i.call(arguments,1),this.callbackContext=a,this.callArgProp=void 0,this.callbackAsync=!1,this},yieldsTo:function(a){return this.callArgAt=k,this.callbackArguments=i.call(arguments,1),this.callbackContext=void 0,this.callArgProp=a,this.callbackAsync=!1,this},yieldsToOn:function(a,b){if("object"!=typeof b)throw new TypeError("argument context is not an object");return this.callArgAt=k,this.callbackArguments=i.call(arguments,2),this.callbackContext=b,this.callArgProp=a,this.callbackAsync=!1,this},"throws":e,throwsException:e,returns:function(a){return this.returnValue=a,this.returnValueDefined=!0,this},returnsArg:function(a){if("number"!=typeof a)throw new TypeError("argument index is not number");return this.returnArgAt=a,this},returnsThis:function(){return this.returnThis=!0,this}};for(var g in d)d.hasOwnProperty(g)&&g.match(/^(callsArg|yields)/)&&!g.match(/Async/)&&(d[g+"Async"]=function(a){return function(){var b=this[a].apply(this,arguments);return this.callbackAsync=!0,b}}(g));return a.behavior=d,d}function h(a,b,c){var d=a("./util/core");a("./extend"),c.exports=g(d)}var i=Array.prototype.slice,j=Array.prototype.join,k=-1,l=-2,m=function(){return"object"==typeof c&&"function"==typeof c.nextTick?c.nextTick:"function"==typeof setImmediate?setImmediate:function(a){setTimeout(a,0)}}(),n="undefined"!=typeof b&&b.exports&&"function"==typeof a,o="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(o)define(h);else if(n)h(a,b.exports,b);else{if(!d)return;g(d)}}("object"==typeof sinon&&sinon||null)}).call(this,a("_process"))},{"./extend":12,"./util/core":24,_process:4}],10:[function(a,b){"use strict";!function(c){function d(a){function b(b,c,e){var f=a.functionName(b)+c;throw e.length&&(f+=" Received ["+d.call(e).join(", ")+"]"),new Error(f)}function c(b,c,d,f,g,h){if("number"!=typeof h)throw new TypeError("Call id is not a number");var i=a.create(e);return i.proxy=b,i.thisValue=c,i.args=d,i.returnValue=f,i.exception=g,i.callId=h,i}var d=Array.prototype.slice,e={calledOn:function(b){return a.match&&a.match.isMatcher(b)?b.test(this.thisValue):this.thisValue===b},calledWith:function(){var b=arguments.length;if(b>this.args.length)return!1;for(var c=0;b>c;c+=1)if(!a.deepEqual(arguments[c],this.args[c]))return!1;return!0},calledWithMatch:function(){var b=arguments.length;if(b>this.args.length)return!1;for(var c=0;b>c;c+=1){var d=this.args[c],e=arguments[c];if(!a.match||!a.match(e).test(d))return!1}return!0},calledWithExactly:function(){return arguments.length==this.args.length&&this.calledWith.apply(this,arguments)},notCalledWith:function(){return!this.calledWith.apply(this,arguments)},notCalledWithMatch:function(){return!this.calledWithMatch.apply(this,arguments)},returned:function(b){return a.deepEqual(b,this.returnValue)},threw:function(a){return"undefined"!=typeof a&&this.exception?this.exception===a||this.exception.name===a:!!this.exception},calledWithNew:function(){return this.proxy.prototype&&this.thisValue instanceof this.proxy},calledBefore:function(a){return this.callId<a.callId},calledAfter:function(a){return this.callId>a.callId},callArg:function(a){this.args[a]()},callArgOn:function(a,b){this.args[a].apply(b)},callArgWith:function(a){this.callArgOnWith.apply(this,[a,null].concat(d.call(arguments,1)))},callArgOnWith:function(a,b){var c=d.call(arguments,2);this.args[a].apply(b,c)},"yield":function(){this.yieldOn.apply(this,[null].concat(d.call(arguments,0)))},yieldOn:function(a){for(var c=this.args,e=0,f=c.length;f>e;++e)if("function"==typeof c[e])return void c[e].apply(a,d.call(arguments,1));b(this.proxy," cannot yield since no callback was passed.",c)},yieldTo:function(a){this.yieldToOn.apply(this,[a,null].concat(d.call(arguments,1)))},yieldToOn:function(a,c){for(var e=this.args,f=0,g=e.length;g>f;++f)if(e[f]&&"function"==typeof e[f][a])return void e[f][a].apply(c,d.call(arguments,2));b(this.proxy," cannot yield to '"+a+"' since no callback was passed.",e)},toString:function(){for(var b=this.proxy.toString()+"(",c=[],d=0,e=this.args.length;e>d;++d)c.push(a.format(this.args[d]));return b=b+c.join(", ")+")","undefined"!=typeof this.returnValue&&(b+=" => "+a.format(this.returnValue)),this.exception&&(b+=" !"+this.exception.name,this.exception.message&&(b+="("+this.exception.message+")")),b}};return e.invokeCallback=e["yield"],c.toString=e.toString,a.spyCall=c,c}function e(a,b,c){var e=a("./util/core");a("./match"),a("./format"),c.exports=d(e)}var f="undefined"!=typeof b&&b.exports&&"function"==typeof a,g="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(g)define(e);else if(f)e(a,b.exports,b);else{if(!c)return;d(c)}}("object"==typeof sinon&&sinon||null)},{"./format":13,"./match":15,"./util/core":24}],11:[function(a,b){"use strict";!function(c){function d(a){return a.fakes||(a.fakes=[]),a.fakes}function e(a,b){for(var c=d(a),e=0,f=c.length;f>e;e+=1)"function"==typeof c[e][b]&&c[e][b]()}function f(a){for(var b=d(a),c=0;c<b.length;)b.splice(c,1)}function g(a){var b={verify:function(){e(this,"verify")},restore:function(){e(this,"restore"),f(this)},reset:function(){e(this,"reset")},verifyAndRestore:function(){var a;try{this.verify()}catch(b){a=b}if(this.restore(),a)throw a},add:function(a){return i.call(d(this),a),a},spy:function(){return this.add(a.spy.apply(a,arguments))},stub:function(b,c,d){if(c){var e=b[c];if("function"!=typeof e){if(!j.call(b,c))throw new TypeError("Cannot stub non-existent own property "+c);return b[c]=d,this.add({restore:function(){b[c]=e}})}}if(!c&&b&&"object"==typeof b){var f=a.stub.apply(a,arguments);for(var g in f)"function"==typeof f[g]&&this.add(f[g]);return f}return this.add(a.stub.apply(a,arguments))},mock:function(){return this.add(a.mock.apply(a,arguments))},inject:function(a){var b=this;return a.spy=function(){return b.spy.apply(b,arguments)},a.stub=function(){return b.stub.apply(b,arguments)},a.mock=function(){return b.mock.apply(b,arguments)},a}};return a.collection=b,b}function h(a,b,c){var d=a("./util/core");a("./mock"),a("./spy"),a("./stub"),c.exports=g(d)}var i=[].push,j=Object.prototype.hasOwnProperty,k="undefined"!=typeof b&&b.exports&&"function"==typeof a,l="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(l)define(h);else if(k)h(a,b.exports,b);else{if(!c)return;g(c)}}("object"==typeof sinon&&sinon||null)},{"./mock":16,"./spy":18,"./stub":19,"./util/core":24}],12:[function(a,b){"use strict";!function(c){function d(a){function b(a){var b,d,e,f=Array.prototype.slice.call(arguments,1);for(d=0;d<f.length;d++){b=f[d];for(e in b)b.hasOwnProperty(e)&&(a[e]=b[e]);c&&b.hasOwnProperty("toString")&&b.toString!==a.toString&&(a.toString=b.toString)}return a}var c=function(){var a={constructor:function(){return"0"},toString:function(){return"1"},valueOf:function(){return"2"},toLocaleString:function(){return"3"},prototype:function(){return"4"},isPrototypeOf:function(){return"5"},propertyIsEnumerable:function(){return"6"},hasOwnProperty:function(){return"7"},length:function(){return"8"},unique:function(){return"9"}},b=[];for(var c in a)b.push(a[c]());return"0123456789"!==b.join("")}();return a.extend=b,a.extend}function e(a,b,c){var e=a("./util/core");c.exports=d(e)}var f="undefined"!=typeof b&&b.exports&&"function"==typeof a,g="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(g)define(e);else if(f)e(a,b.exports,b);else{if(!c)return;d(c)}}("object"==typeof sinon&&sinon||null)},{"./util/core":24}],13:[function(a,b){"use strict";!function(c,d){function e(c){function e(a){return""+a}function f(){function a(){return b.ascii.apply(b,arguments)}var b=d.configure({quoteStrings:!1,limitChildrenCount:250});return a}function g(){function b(a){return"object"==typeof a&&a.toString===Object.prototype.toString?c.inspect(a):a}try{var c=a("util")}catch(d){}return c?b:e}var h,i="undefined"!=typeof b&&b.exports&&"function"==typeof a;if(i)try{d=a("formatio")}catch(j){}return h=d?f():i?g():e,c.format=h,c.format}function f(a,b,c){var d=a("./util/core");c.exports=e(d)}var g="undefined"!=typeof b&&b.exports&&"function"==typeof a,h="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(h)define(f);else if(g)f(a,b.exports,b);else{if(!c)return;e(c)}}("object"==typeof sinon&&sinon||null,"object"==typeof formatio&&formatio)},{"./util/core":24,formatio:31,util:6}],14:[function(a,b){"use strict";!function(c){function d(a){function b(){}function c(b,d){var e=b+" threw exception: ";a.log(e+"["+d.name+"] "+d.message),d.stack&&a.log(d.stack),c.setTimeout(function(){throw d.message=e+d.message,d},0)}c.setTimeout=function(a,b){f(a,b)};var d={};return d.log=a.log=b,d.logError=a.logError=c,d}function e(a,b,c){var e=a("./util/core");c.exports=d(e)}var f=setTimeout,g="undefined"!=typeof b&&b.exports&&"function"==typeof a,h="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(h)define(e);else if(g)e(a,b.exports,b);else{if(!c)return;d(c)}}("object"==typeof sinon&&sinon||null)},{"./util/core":24}],15:[function(a,b){"use strict";!function(c){function d(a){function b(b,c,d){var e=a.typeOf(b);if(e!==c)throw new TypeError("Expected type of "+d+" to be "+c+", but was "+e)}function c(a){return f.isPrototypeOf(a)}function d(b,c){if(null===c||void 0===c)return!1;for(var e in b)if(b.hasOwnProperty(e)){var f=b[e],h=c[e];if(g.isMatcher(f)){if(!f.test(h))return!1}else if("object"===a.typeOf(f)){if(!d(f,h))return!1}else if(!a.deepEqual(f,h))return!1}return!0}function e(c,d){return function(e,f){b(e,"string","property");var h=1===arguments.length,i=d+'("'+e+'"';return h||(i+=", "+f),i+=")",g(function(b){return void 0!==b&&null!==b&&c(b,e)?h||a.deepEqual(f,b[e]):!1},i)}}var f={toString:function(){return this.message}};f.or=function(b){if(!arguments.length)throw new TypeError("Matcher expected");c(b)||(b=g(b));var d=this,e=a.create(f);return e.test=function(a){return d.test(a)||b.test(a)},e.message=d.message+".or("+b.message+")",e},f.and=function(b){if(!arguments.length)throw new TypeError("Matcher expected");c(b)||(b=g(b));var d=this,e=a.create(f);return e.test=function(a){return d.test(a)&&b.test(a)},e.message=d.message+".and("+b.message+")",e};var g=function(b,c){var e=a.create(f),g=a.typeOf(b);switch(g){case"object":if("function"==typeof b.test)return e.test=function(a){return b.test(a)===!0},e.message="match("+a.functionName(b.test)+")",e;var h=[];for(var i in b)b.hasOwnProperty(i)&&h.push(i+": "+b[i]);e.test=function(a){return d(b,a)},e.message="match("+h.join(", ")+")";break;case"number":e.test=function(a){return b==a};break;case"string":e.test=function(a){return"string"!=typeof a?!1:-1!==a.indexOf(b)},e.message='match("'+b+'")';break;case"regexp":e.test=function(a){return"string"!=typeof a?!1:b.test(a)};break;case"function":e.test=b,e.message=c?c:"match("+a.functionName(b)+")";break;default:e.test=function(c){return a.deepEqual(b,c)}}return e.message||(e.message="match("+b+")"),e};return g.isMatcher=c,g.any=g(function(){return!0},"any"),g.defined=g(function(a){return null!==a&&void 0!==a},"defined"),g.truthy=g(function(a){return!!a},"truthy"),g.falsy=g(function(a){return!a},"falsy"),g.same=function(a){return g(function(b){return a===b},"same("+a+")")},g.typeOf=function(c){return b(c,"string","type"),g(function(b){return a.typeOf(b)===c},'typeOf("'+c+'")')},g.instanceOf=function(c){return b(c,"function","type"),g(function(a){return a instanceof c},"instanceOf("+a.functionName(c)+")")},g.has=e(function(a,b){return"object"==typeof a?b in a:void 0!==a[b]},"has"),g.hasOwn=e(function(a,b){return a.hasOwnProperty(b)},"hasOwn"),g.bool=g.typeOf("boolean"),g.number=g.typeOf("number"),g.string=g.typeOf("string"),g.object=g.typeOf("object"),g.func=g.typeOf("function"),g.array=g.typeOf("array"),g.regexp=g.typeOf("regexp"),g.date=g.typeOf("date"),a.match=g,g}function e(a,b,c){var e=a("./util/core");a("./typeOf"),c.exports=d(e)
}var f="undefined"!=typeof b&&b.exports&&"function"==typeof a,g="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(g)define(e);else if(f)e(a,b.exports,b);else{if(!c)return;d(c)}}("object"==typeof sinon&&sinon||null)},{"./typeOf":23,"./util/core":24}],16:[function(a,b){"use strict";!function(c){function d(a){function b(c){return c?b.create(c):a.expectation.create("Anonymous mock")}function c(a,b){if(a)for(var c=0,d=a.length;d>c;c+=1)b(a[c])}function d(a){return 0==a?"never called":"called "+k(a)}function e(a){var b=a.minCalls,c=a.maxCalls;if("number"==typeof b&&"number"==typeof c){var d=k(b);return b!=c&&(d="at least "+d+" and at most "+k(c)),d}return"number"==typeof b?"at least "+k(b):"at most "+k(c)}function f(a){var b="number"==typeof a.minCalls;return!b||a.callCount>=a.minCalls}function g(a){return"number"!=typeof a.maxCalls?!1:a.callCount==a.maxCalls}function h(a,b){return j&&j.isMatcher(a)?a.test(b):!0}var i=[].push,j=a.match;a.extend(b,{create:function(c){if(!c)throw new TypeError("object is null");var d=a.extend({},b);return d.object=c,delete d.create,d},expects:function(b){if(!b)throw new TypeError("method is falsy");if(this.expectations||(this.expectations={},this.proxies=[]),!this.expectations[b]){this.expectations[b]=[];var c=this;a.wrapMethod(this.object,b,function(){return c.invokeMethod(b,this,arguments)}),i.call(this.proxies,b)}var d=a.expectation.create(b);return i.call(this.expectations[b],d),d},restore:function(){var a=this.object;c(this.proxies,function(b){"function"==typeof a[b].restore&&a[b].restore()})},verify:function(){var b=this.expectations||{},d=[],e=[];return c(this.proxies,function(a){c(b[a],function(a){a.met()?i.call(e,a.toString()):i.call(d,a.toString())})}),this.restore(),d.length>0?a.expectation.fail(d.concat(e).join("\n")):e.length>0&&a.expectation.pass(d.concat(e).join("\n")),!0},invokeMethod:function(b,c,d){var e,f=this.expectations&&this.expectations[b],g=f&&f.length||0;for(e=0;g>e;e+=1)if(!f[e].met()&&f[e].allowsCall(c,d))return f[e].apply(c,d);var h,j=[],k=0;for(e=0;g>e;e+=1)f[e].allowsCall(c,d)?h=h||f[e]:k+=1,i.call(j,"    "+f[e].toString());return 0===k?h.apply(c,d):(j.unshift("Unexpected call: "+a.spyCall.toString.call({proxy:b,args:d})),void a.expectation.fail(j.join("\n")))}});var k=a.timesInWords,l=Array.prototype.slice;return a.expectation={minCalls:1,maxCalls:1,create:function(b){var c=a.extend(a.stub.create(),a.expectation);return delete c.create,c.method=b,c},invoke:function(b,c,d){return this.verifyCallAllowed(c,d),a.spy.invoke.apply(this,arguments)},atLeast:function(a){if("number"!=typeof a)throw new TypeError("'"+a+"' is not number");return this.limitsSet||(this.maxCalls=null,this.limitsSet=!0),this.minCalls=a,this},atMost:function(a){if("number"!=typeof a)throw new TypeError("'"+a+"' is not number");return this.limitsSet||(this.minCalls=null,this.limitsSet=!0),this.maxCalls=a,this},never:function(){return this.exactly(0)},once:function(){return this.exactly(1)},twice:function(){return this.exactly(2)},thrice:function(){return this.exactly(3)},exactly:function(a){if("number"!=typeof a)throw new TypeError("'"+a+"' is not a number");return this.atLeast(a),this.atMost(a)},met:function(){return!this.failed&&f(this)},verifyCallAllowed:function(b,c){if(g(this)&&(this.failed=!0,a.expectation.fail(this.method+" already called "+k(this.maxCalls))),"expectedThis"in this&&this.expectedThis!==b&&a.expectation.fail(this.method+" called with "+b+" as thisValue, expected "+this.expectedThis),"expectedArguments"in this){c||a.expectation.fail(this.method+" received no arguments, expected "+a.format(this.expectedArguments)),c.length<this.expectedArguments.length&&a.expectation.fail(this.method+" received too few arguments ("+a.format(c)+"), expected "+a.format(this.expectedArguments)),this.expectsExactArgCount&&c.length!=this.expectedArguments.length&&a.expectation.fail(this.method+" received too many arguments ("+a.format(c)+"), expected "+a.format(this.expectedArguments));for(var d=0,e=this.expectedArguments.length;e>d;d+=1)h(this.expectedArguments[d],c[d])||a.expectation.fail(this.method+" received wrong arguments "+a.format(c)+", didn't match "+this.expectedArguments.toString()),a.deepEqual(this.expectedArguments[d],c[d])||a.expectation.fail(this.method+" received wrong arguments "+a.format(c)+", expected "+a.format(this.expectedArguments))}},allowsCall:function(b,c){if(this.met()&&g(this))return!1;if("expectedThis"in this&&this.expectedThis!==b)return!1;if(!("expectedArguments"in this))return!0;if(c=c||[],c.length<this.expectedArguments.length)return!1;if(this.expectsExactArgCount&&c.length!=this.expectedArguments.length)return!1;for(var d=0,e=this.expectedArguments.length;e>d;d+=1){if(!h(this.expectedArguments[d],c[d]))return!1;if(!a.deepEqual(this.expectedArguments[d],c[d]))return!1}return!0},withArgs:function(){return this.expectedArguments=l.call(arguments),this},withExactArgs:function(){return this.withArgs.apply(this,arguments),this.expectsExactArgCount=!0,this},on:function(a){return this.expectedThis=a,this},toString:function(){var b=(this.expectedArguments||[]).slice();this.expectsExactArgCount||i.call(b,"[...]");var c=a.spyCall.toString.call({proxy:this.method||"anonymous mock expectation",args:b}),f=c.replace(", [...","[, ...")+" "+e(this);return this.met()?"Expectation met: "+f:"Expected "+f+" ("+d(this.callCount)+")"},verify:function(){return this.met()?a.expectation.pass(this.toString()):a.expectation.fail(this.toString()),!0},pass:function(b){a.assert.pass(b)},fail:function(a){var b=new Error(a);throw b.name="ExpectationError",b}},a.mock=b,b}function e(a,b,c){var e=a("./util/core");a("./times_in_words"),a("./call"),a("./extend"),a("./match"),a("./spy"),a("./stub"),a("./format"),c.exports=d(e)}var f="undefined"!=typeof b&&b.exports&&"function"==typeof a,g="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(g)define(e);else if(f)e(a,b.exports,b);else{if(!c)return;d(c)}}("object"==typeof sinon&&sinon||null)},{"./call":10,"./extend":12,"./format":13,"./match":15,"./spy":18,"./stub":19,"./times_in_words":22,"./util/core":24}],17:[function(a,b){"use strict";!function(){function c(a){function b(a,b,c,e){e&&(!b.injectInto||c in b.injectInto?d.call(a.args,e):(b.injectInto[c]=e,a.injectedKeys.push(c)))}function c(b){var c=a.create(a.sandbox);return b.useFakeServer&&("object"==typeof b.useFakeServer&&(c.serverPrototype=b.useFakeServer),c.useFakeServer()),b.useFakeTimers&&("object"==typeof b.useFakeTimers?c.useFakeTimers.apply(c,b.useFakeTimers):c.useFakeTimers()),c}var d=[].push;return a.sandbox=a.extend(a.create(a.collection),{useFakeTimers:function(){return this.clock=a.useFakeTimers.apply(a,arguments),this.add(this.clock)},serverPrototype:a.fakeServer,useFakeServer:function(){var b=this.serverPrototype||a.fakeServer;return b&&b.create?(this.server=b.create(),this.add(this.server)):null},inject:function(b){return a.collection.inject.call(this,b),this.clock&&(b.clock=this.clock),this.server&&(b.server=this.server,b.requests=this.server.requests),b.match=a.match,b},restore:function(){a.collection.restore.apply(this,arguments),this.restoreContext()},restoreContext:function(){if(this.injectedKeys){for(var a=0,b=this.injectedKeys.length;b>a;a++)delete this.injectInto[this.injectedKeys[a]];this.injectedKeys=[]}},create:function(d){if(!d)return a.create(a.sandbox);var e=c(d);e.args=e.args||[],e.injectedKeys=[],e.injectInto=d.injectInto;var f,g,h=e.inject({});if(d.properties)for(var i=0,j=d.properties.length;j>i;i++)f=d.properties[i],g=h[f]||"sandbox"==f&&e,b(e,d,f,g);else b(e,d,"sandbox",g);return e},match:a.match}),a.sandbox.useFakeXMLHttpRequest=a.sandbox.useFakeServer,a.sandbox}function d(a,b,d){var e=a("./util/core");a("./extend"),a("./util/fake_server_with_clock"),a("./util/fake_timers"),a("./collection"),d.exports=c(e)}var e="undefined"!=typeof b&&b.exports&&"function"==typeof a,f="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(f)define(d);else if(e)d(a,b.exports,b);else{if(!sinon)return;c(sinon)}}()},{"./collection":11,"./extend":12,"./util/core":24,"./util/fake_server_with_clock":27,"./util/fake_timers":28}],18:[function(require,module,exports){"use strict";!function(sinon){function makeApi(sinon){function spy(a,b){if(!b&&"function"==typeof a)return spy.create(a);if(!a&&!b)return spy.create(function(){});var c=a[b];return sinon.wrapMethod(a,b,spy.create(c))}function matchingFake(a,b,c){if(a)for(var d=0,e=a.length;e>d;d++)if(a[d].matches(b,c))return a[d]}function incrementCallCount(){this.called=!0,this.callCount+=1,this.notCalled=!1,this.calledOnce=1==this.callCount,this.calledTwice=2==this.callCount,this.calledThrice=3==this.callCount}function createCallProperties(){this.firstCall=this.getCall(0),this.secondCall=this.getCall(1),this.thirdCall=this.getCall(2),this.lastCall=this.getCall(this.callCount-1)}function createProxy(func,proxyLength){var p;return proxyLength?eval("p = (function proxy("+vars.substring(0,2*proxyLength-1)+") { return p.invoke(func, this, slice.call(arguments)); });"):p=function(){return p.invoke(func,this,slice.call(arguments))},p}function delegateToCalls(a,b,c,d){spyApi[a]=function(){if(!this.called)return d?d.apply(this,arguments):!1;for(var e,f=0,g=0,h=this.callCount;h>g;g+=1)if(e=this.getCall(g),e[c||a].apply(e,arguments)&&(f+=1,b))return!0;return f===this.callCount}}var push=Array.prototype.push,slice=Array.prototype.slice,callId=0,vars="a,b,c,d,e,f,g,h,i,j,k,l",uuid=0,spyApi={reset:function(){if(this.invoking){var a=new Error("Cannot reset Sinon function while invoking it. Move the call to .reset outside of the callback.");throw a.name="InvalidResetException",a}if(this.called=!1,this.notCalled=!0,this.calledOnce=!1,this.calledTwice=!1,this.calledThrice=!1,this.callCount=0,this.firstCall=null,this.secondCall=null,this.thirdCall=null,this.lastCall=null,this.args=[],this.returnValues=[],this.thisValues=[],this.exceptions=[],this.callIds=[],this.fakes)for(var b=0;b<this.fakes.length;b++)this.fakes[b].reset();return this},create:function(a,b){var c;"function"!=typeof a?a=function(){}:c=sinon.functionName(a),b||(b=a.length);var d=createProxy(a,b);return sinon.extend(d,spy),delete d.create,sinon.extend(d,a),d.reset(),d.prototype=a.prototype,d.displayName=c||"spy",d.toString=sinon.functionToString,d.instantiateFake=sinon.spy.create,d.id="spy#"+uuid++,d},invoke:function(a,b,c){var d,e,f=matchingFake(this.fakes,c);incrementCallCount.call(this),push.call(this.thisValues,b),push.call(this.args,c),push.call(this.callIds,callId++),createCallProperties.call(this);try{this.invoking=!0,e=f?f.invoke(a,b,c):(this.func||a).apply(b,c);var g=this.getCall(this.callCount-1);g.calledWithNew()&&"object"!=typeof e&&(e=b)}catch(h){d=h}finally{delete this.invoking}if(push.call(this.exceptions,d),push.call(this.returnValues,e),createCallProperties.call(this),void 0!==d)throw d;return e},named:function(a){return this.displayName=a,this},getCall:function(a){return 0>a||a>=this.callCount?null:sinon.spyCall(this,this.thisValues[a],this.args[a],this.returnValues[a],this.exceptions[a],this.callIds[a])},getCalls:function(){var a,b=[];for(a=0;a<this.callCount;a++)b.push(this.getCall(a));return b},calledBefore:function(a){return this.called?a.called?this.callIds[0]<a.callIds[a.callIds.length-1]:!0:!1},calledAfter:function(a){return this.called&&a.called?this.callIds[this.callCount-1]>a.callIds[a.callCount-1]:!1},withArgs:function(){var a=slice.call(arguments);if(this.fakes){var b=matchingFake(this.fakes,a,!0);if(b)return b}else this.fakes=[];var c=this,d=this.instantiateFake();d.matchingAguments=a,d.parent=this,push.call(this.fakes,d),d.withArgs=function(){return c.withArgs.apply(c,arguments)};for(var e=0;e<this.args.length;e++)d.matches(this.args[e])&&(incrementCallCount.call(d),push.call(d.thisValues,this.thisValues[e]),push.call(d.args,this.args[e]),push.call(d.returnValues,this.returnValues[e]),push.call(d.exceptions,this.exceptions[e]),push.call(d.callIds,this.callIds[e]));return createCallProperties.call(d),d},matches:function(a,b){var c=this.matchingAguments;return c.length<=a.length&&sinon.deepEqual(c,a.slice(0,c.length))?!b||c.length==a.length:void 0},printf:function(a){var b,c=this,d=slice.call(arguments,1);return(a||"").replace(/%(.)/g,function(a,e){return b=spyApi.formatters[e],"function"==typeof b?b.call(null,c,d):isNaN(parseInt(e,10))?"%"+e:sinon.format(d[e-1])})}};return delegateToCalls("calledOn",!0),delegateToCalls("alwaysCalledOn",!1,"calledOn"),delegateToCalls("calledWith",!0),delegateToCalls("calledWithMatch",!0),delegateToCalls("alwaysCalledWith",!1,"calledWith"),delegateToCalls("alwaysCalledWithMatch",!1,"calledWithMatch"),delegateToCalls("calledWithExactly",!0),delegateToCalls("alwaysCalledWithExactly",!1,"calledWithExactly"),delegateToCalls("neverCalledWith",!1,"notCalledWith",function(){return!0}),delegateToCalls("neverCalledWithMatch",!1,"notCalledWithMatch",function(){return!0}),delegateToCalls("threw",!0),delegateToCalls("alwaysThrew",!1,"threw"),delegateToCalls("returned",!0),delegateToCalls("alwaysReturned",!1,"returned"),delegateToCalls("calledWithNew",!0),delegateToCalls("alwaysCalledWithNew",!1,"calledWithNew"),delegateToCalls("callArg",!1,"callArgWith",function(){throw new Error(this.toString()+" cannot call arg since it was not yet invoked.")}),spyApi.callArgWith=spyApi.callArg,delegateToCalls("callArgOn",!1,"callArgOnWith",function(){throw new Error(this.toString()+" cannot call arg since it was not yet invoked.")}),spyApi.callArgOnWith=spyApi.callArgOn,delegateToCalls("yield",!1,"yield",function(){throw new Error(this.toString()+" cannot yield since it was not yet invoked.")}),spyApi.invokeCallback=spyApi["yield"],delegateToCalls("yieldOn",!1,"yieldOn",function(){throw new Error(this.toString()+" cannot yield since it was not yet invoked.")}),delegateToCalls("yieldTo",!1,"yieldTo",function(a){throw new Error(this.toString()+" cannot yield to '"+a+"' since it was not yet invoked.")}),delegateToCalls("yieldToOn",!1,"yieldToOn",function(a){throw new Error(this.toString()+" cannot yield to '"+a+"' since it was not yet invoked.")}),spyApi.formatters={c:function(a){return sinon.timesInWords(a.callCount)},n:function(a){return a.toString()},C:function(a){for(var b=[],c=0,d=a.callCount;d>c;++c){var e="    "+a.getCall(c).toString();/\n/.test(b[c-1])&&(e="\n"+e),push.call(b,e)}return b.length>0?"\n"+b.join("\n"):""},t:function(a){for(var b=[],c=0,d=a.callCount;d>c;++c)push.call(b,sinon.format(a.thisValues[c]));return b.join(", ")},"*":function(a,b){for(var c=[],d=0,e=b.length;e>d;++d)push.call(c,sinon.format(b[d]));return c.join(", ")}},sinon.extend(spy,spyApi),spy.spyCall=sinon.spyCall,sinon.spy=spy,spy}function loadDependencies(a,b,c){var d=a("./util/core");a("./call"),a("./extend"),a("./times_in_words"),a("./format"),c.exports=makeApi(d)}var isNode="undefined"!=typeof module&&module.exports&&"function"==typeof require,isAMD="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(isAMD)define(loadDependencies);else if(isNode)loadDependencies(require,module.exports,module);else{if(!sinon)return;makeApi(sinon)}}("object"==typeof sinon&&sinon||null)},{"./call":10,"./extend":12,"./format":13,"./times_in_words":22,"./util/core":24}],19:[function(a,b){"use strict";!function(c){function d(a){function b(c,d,e){if(e&&"function"!=typeof e)throw new TypeError("Custom stub should be function");var f;if(e)f=a.spy&&a.spy.create?a.spy.create(e):e;else{var g=0;"object"==typeof c&&"function"==typeof c[d]&&(g=c[d].length),f=b.create(g)}if(!c&&"undefined"==typeof d)return a.stub.create();if("undefined"==typeof d&&"object"==typeof c){for(var h in c)"function"==typeof c[h]&&b(c,h);return c}return a.wrapMethod(c,d,f)}function c(b){return b.defaultBehavior||d(b)||a.behavior.create(b)}function d(a){return a.parent&&e(a.parent)}function e(a){var b=a.behaviors[a.callCount-1];return b&&b.isPresent()?b:c(a)}var f=0,g={create:function(c){var d=function(){return e(d).invoke(this,arguments)};d.id="stub#"+f++;var g=d;return d=a.spy.create(d,c),d.func=g,a.extend(d,b),d.instantiateFake=a.stub.create,d.displayName="stub",d.toString=a.functionToString,d.defaultBehavior=null,d.behaviors=[],d},resetBehavior:function(){var a;if(this.defaultBehavior=null,this.behaviors=[],delete this.returnValue,delete this.returnArgAt,this.returnThis=!1,this.fakes)for(a=0;a<this.fakes.length;a++)this.fakes[a].resetBehavior()},onCall:function(b){return this.behaviors[b]||(this.behaviors[b]=a.behavior.create(this)),this.behaviors[b]},onFirstCall:function(){return this.onCall(0)},onSecondCall:function(){return this.onCall(1)},onThirdCall:function(){return this.onCall(2)}};for(var h in a.behavior)a.behavior.hasOwnProperty(h)&&!g.hasOwnProperty(h)&&"create"!=h&&"withArgs"!=h&&"invoke"!=h&&(g[h]=function(b){return function(){return this.defaultBehavior=this.defaultBehavior||a.behavior.create(this),this.defaultBehavior[b].apply(this.defaultBehavior,arguments),this}}(h));return a.extend(b,g),a.stub=b,b}function e(a,b,c){var e=a("./util/core");a("./behavior"),a("./spy"),a("./extend"),c.exports=d(e)}var f="undefined"!=typeof b&&b.exports&&"function"==typeof a,g="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(g)define(e);else if(f)e(a,b.exports,b);else{if(!c)return;d(c)}}("object"==typeof sinon&&sinon||null)},{"./behavior":9,"./extend":12,"./spy":18,"./util/core":24}],20:[function(a,b){"use strict";!function(c){function d(a){function b(b){function d(){var d=a.getConfig(a.config);d.injectInto=d.injectIntoThis&&this||d.injectInto;var e,f,g=a.sandbox.create(d),h=c.call(arguments),i=h.length&&h[h.length-1];"function"==typeof i&&(h[h.length-1]=function(a){if(a)throw g.restore(),e;g.verifyAndRestore(),i(a)});try{f=b.apply(this,h.concat(g.args))}catch(j){e=j}if("function"!=typeof i){if("undefined"!=typeof e)throw g.restore(),e;g.verifyAndRestore()}return f}var e=typeof b;if("function"!=e)throw new TypeError("sinon.test needs to wrap a test function, got "+e);return b.length?function(){return d.apply(this,arguments)}:d}var c=Array.prototype.slice;return b.config={injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},a.test=b,b}function e(a,b,c){var e=a("./util/core");a("./sandbox"),c.exports=d(e)}var f="undefined"!=typeof b&&b.exports&&"function"==typeof a,g="function"==typeof define&&"object"==typeof define.amd&&define.amd;g?define(e):f?e(a,b.exports,b):c&&d(c)}("object"==typeof sinon&&sinon||null)},{"./sandbox":17,"./util/core":24}],21:[function(a,b){"use strict";!function(c){function d(a,b,c){return function(){b&&b.apply(this,arguments);var d,e;try{e=a.apply(this,arguments)}catch(f){d=f}if(c&&c.apply(this,arguments),d)throw d;return e}}function e(a){function b(b,c){if(!b||"object"!=typeof b)throw new TypeError("sinon.testCase needs an object with test functions");c=c||"test";var e,f,g,h=new RegExp("^"+c),i={},j=b.setUp,k=b.tearDown;for(e in b)if(b.hasOwnProperty(e)){if(f=b[e],/^(setUp|tearDown)$/.test(e))continue;"function"==typeof f&&h.test(e)?(g=f,(j||k)&&(g=d(f,j,k)),i[e]=a.test(g)):i[e]=b[e]}return i}return a.testCase=b,b}function f(a,b,c){var d=a("./util/core");a("./test"),c.exports=e(d)}var g="undefined"!=typeof b&&b.exports&&"function"==typeof a,h="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(h)define(f);else if(g)f(a,b.exports,b);else{if(!c)return;e(c)}}("object"==typeof sinon&&sinon||null)},{"./test":20,"./util/core":24}],22:[function(a,b){"use strict";!function(c){function d(a){function b(a){switch(a){case 1:return"once";case 2:return"twice";case 3:return"thrice";default:return(a||0)+" times"}}return a.timesInWords=b,a.timesInWords}function e(a,b,c){var e=a("./util/core");c.exports=d(e)}var f="undefined"!=typeof b&&b.exports&&"function"==typeof a,g="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(g)define(e);else if(f)e(a,b.exports,b);else{if(!c)return;d(c)}}("object"==typeof sinon&&sinon||null)},{"./util/core":24}],23:[function(a,b){"use strict";!function(c){function d(a){function b(a){if(null===a)return"null";if(void 0===a)return"undefined";var b=Object.prototype.toString.call(a);return b.substring(8,b.length-1).toLowerCase()}return a.typeOf=b,a.typeOf}function e(a,b,c){var e=a("./util/core");c.exports=d(e)}var f="undefined"!=typeof b&&b.exports&&"function"==typeof a,g="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(g)define(e);else if(f)e(a,b.exports,b);else{if(!c)return;d(c)}}("object"==typeof sinon&&sinon||null,"object"==typeof formatio&&formatio)},{"./util/core":24}],24:[function(a,b){"use strict";!function(c){function d(a){var b=!1;try{a.appendChild(l),b=l.parentNode==a}catch(c){return!1}finally{try{a.removeChild(l)}catch(c){}}return b}function e(a){return l&&a&&1===a.nodeType&&d(a)}function f(a){return"function"==typeof a||!!(a&&a.constructor&&a.call&&a.apply)}function g(a){return"number"==typeof a&&isNaN(a)}function h(a,b){for(var c in b)m.call(a,c)||(a[c]=b[c])}function i(a){return"function"==typeof a&&"function"==typeof a.restore&&a.restore.sinon}function j(a){return a.wrapMethod=function(a,b,c){if(!a)throw new TypeError("Should wrap property of object");if("function"!=typeof c)throw new TypeError("Method wrapper should be function");var d,e=a[b];if(f(e)){if(e.restore&&e.restore.sinon)d=new TypeError("Attempted to wrap "+b+" which is already wrapped");else if(e.calledBefore){var g=e.returns?"stubbed":"spied on";d=new TypeError("Attempted to wrap "+b+" which is already "+g)}}else d=new TypeError("Attempted to wrap "+typeof e+" property "+b+" as function");if(d)throw e&&e.stackTrace&&(d.stack+="\n--------------\n"+e.stackTrace),d;var i=a.hasOwnProperty?a.hasOwnProperty(b):m.call(a,b);return a[b]=c,c.displayName=b,c.stackTrace=new Error("Stack Trace for original").stack,c.restore=function(){i||delete a[b],a[b]===c&&(a[b]=e)},c.restore.sinon=!0,h(c,e),c},a.create=function(a){var b=function(){};return b.prototype=a,new b},a.deepEqual=function b(c,d){if(a.match&&a.match.isMatcher(c))return c.test(d);if("object"!=typeof c||"object"!=typeof d)return g(c)&&g(d)?!0:c===d;if(e(c)||e(d))return c===d;if(c===d)return!0;if(null===c&&null!==d||null!==c&&null===d)return!1;if(c instanceof RegExp&&d instanceof RegExp)return c.source===d.source&&c.global===d.global&&c.ignoreCase===d.ignoreCase&&c.multiline===d.multiline;var f=Object.prototype.toString.call(c);if(f!=Object.prototype.toString.call(d))return!1;if("[object Date]"==f)return c.valueOf()===d.valueOf();var h,i=0,j=0;if("[object Array]"==f&&c.length!==d.length)return!1;for(h in c){if(i+=1,!(h in d))return!1;if(!b(c[h],d[h]))return!1}for(h in d)j+=1;return i==j},a.functionName=function(a){var b=a.displayName||a.name;if(!b){var c=a.toString().match(/function ([^\s\(]+)/);b=c&&c[1]}return b},a.functionToString=function(){if(this.getCall&&this.callCount)for(var a,b,c=this.callCount;c--;){a=this.getCall(c).thisValue;for(b in a)if(a[b]===this)return b}return this.displayName||"sinon fake"},a.getConfig=function(b){var c={};b=b||{};var d=a.defaultConfig;for(var e in d)d.hasOwnProperty(e)&&(c[e]=b.hasOwnProperty(e)?b[e]:d[e]);return c},a.defaultConfig={injectIntoThis:!0,injectInto:null,properties:["spy","stub","mock","clock","server","requests"],useFakeTimers:!0,useFakeServer:!0},a.timesInWords=function(a){return 1==a&&"once"||2==a&&"twice"||3==a&&"thrice"||(a||0)+" times"},a.calledInOrder=function(a){for(var b=1,c=a.length;c>b;b++)if(!a[b-1].calledBefore(a[b])||!a[b].called)return!1;return!0},a.orderByFirstCall=function(a){return a.sort(function(a,b){var c=a.getCall(0),d=b.getCall(0),e=c&&c.callId||-1,f=d&&d.callId||-1;return f>e?-1:1})},a.createStubInstance=function(b){if("function"!=typeof b)throw new TypeError("The constructor should be a function.");return a.stub(a.create(b.prototype))},a.restore=function(a){if(null!==a&&"object"==typeof a)for(var b in a)i(a[b])&&a[b].restore();else i(a)&&a.restore()},a}function k(a,b){j(b)}var l="undefined"!=typeof document&&document.createElement("div"),m=Object.prototype.hasOwnProperty,n="undefined"!=typeof b&&b.exports&&"function"==typeof a,o="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(o)define(k);else if(n)k(a,b.exports);else{if(!c)return;j(c)}}("object"==typeof sinon&&sinon||null)},{}],25:[function(a,b){"use strict";"undefined"==typeof sinon&&(this.sinon={}),function(){function c(a){a.Event=function(a,b,c,d){this.initEvent(a,b,c,d)},a.Event.prototype={initEvent:function(a,b,c,d){this.type=a,this.bubbles=b,this.cancelable=c,this.target=d},stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=!0}},a.ProgressEvent=function(a,b,c){this.initEvent(a,!1,!1,c),this.loaded=b.loaded||null,this.total=b.total||null,this.lengthComputable=!!b.total},a.ProgressEvent.prototype=new a.Event,a.ProgressEvent.prototype.constructor=a.ProgressEvent,a.CustomEvent=function(a,b,c){this.initEvent(a,!1,!1,c),this.detail=b.detail||null},a.CustomEvent.prototype=new a.Event,a.CustomEvent.prototype.constructor=a.CustomEvent,a.EventTarget={addEventListener:function(a,b){this.eventListeners=this.eventListeners||{},this.eventListeners[a]=this.eventListeners[a]||[],e.call(this.eventListeners[a],b)},removeEventListener:function(a,b){for(var c=this.eventListeners&&this.eventListeners[a]||[],d=0,e=c.length;e>d;++d)if(c[d]==b)return c.splice(d,1)},dispatchEvent:function(a){for(var b=a.type,c=this.eventListeners&&this.eventListeners[b]||[],d=0;d<c.length;d++)"function"==typeof c[d]?c[d].call(this,a):c[d].handleEvent(a);return!!a.defaultPrevented}}}function d(a){var b=a("./core");c(b)}var e=[].push,f="undefined"!=typeof b&&b.exports&&"function"==typeof a,g="function"==typeof define&&"object"==typeof define.amd&&define.amd;g?define(d):f?d(a):c(sinon)}()},{"./core":24}],26:[function(a,b){"use strict";if("undefined"==typeof c)var c={};!function(){function d(){}function e(a){return d.prototype=a,new d}function f(a){var b=a;if("[object Array]"!=Object.prototype.toString.call(a)&&(b=[200,{},a]),"string"!=typeof b[2])throw new TypeError("Fake server response body should be string, but was "+typeof b[2]);return b}function g(a,b,c){var d=a.method,e=!d||d.toLowerCase()==b.toLowerCase(),f=a.url,g=!f||f==c||"function"==typeof f.test&&f.test(c);return e&&g}function h(a,b){var c=b.url;if((!/^https?:\/\//.test(c)||m.test(c))&&(c=c.replace(m,"")),g(a,this.getHTTPMethod(b),c)){if("function"==typeof a.response){var d=a.url,e=[b].concat(d&&"function"==typeof d.exec?d.exec(c).slice(1):[]);return a.response.apply(a,e)}return!0}return!1}function i(a){a.fakeServer={create:function(){var b=e(this);return this.xhr=a.xhr.supportsCORS?a.useFakeXMLHttpRequest():a.useFakeXDomainRequest(),b.requests=[],this.xhr.onCreate=function(a){b.addRequest(a)},b},addRequest:function(a){var b=this;k.call(this.requests,a),a.onSend=function(){b.handleRequest(this),b.autoRespond&&!b.responding&&(setTimeout(function(){b.responding=!1,b.respond()},b.autoRespondAfter||10),b.responding=!0)}},getHTTPMethod:function(a){if(this.fakeHTTPMethods&&/post/i.test(a.method)){var b=(a.requestBody||"").match(/_method=([^\b;]+)/);return b?b[1]:a.method}return a.method},handleRequest:function(a){a.async?(this.queue||(this.queue=[]),k.call(this.queue,a)):this.processRequest(a)},log:function(b,c){var d;d="Request:\n"+a.format(c)+"\n\n",d+="Response:\n"+a.format(b)+"\n\n",a.log(d)},respondWith:function(a,b,c){return 1==arguments.length&&"function"!=typeof a?void(this.response=f(a)):(this.responses||(this.responses=[]),1==arguments.length&&(c=a,b=a=null),2==arguments.length&&(c=b,b=a,a=null),void k.call(this.responses,{method:a,url:b,response:"function"==typeof c?c:f(c)}))},respond:function(){arguments.length>0&&this.respondWith.apply(this,arguments);for(var a,b=this.queue||[],c=b.splice(0,b.length);a=c.shift();)this.processRequest(a)},processRequest:function(b){try{if(b.aborted)return;var c=this.response||[404,{},""];if(this.responses)for(var d=this.responses.length,e=d-1;e>=0;e--)if(h.call(this,this.responses[e],b)){c=this.responses[e].response;break}4!=b.readyState&&(this.log(c,b),b.respond(c[0],c[1],c[2]))}catch(f){a.logError("Fake server request processing",f)}},restore:function(){return this.xhr.restore&&this.xhr.restore.apply(this.xhr,arguments)}}}function j(a,b,c){var d=a("./core");a("./fake_xdomain_request"),a("./fake_xml_http_request"),a("../format"),i(d),c.exports=d}var k=[].push,l="undefined"!=typeof window?window.location:{},m=new RegExp("^"+l.protocol+"//"+l.host),n="undefined"!=typeof b&&b.exports&&"function"==typeof a,o="function"==typeof define&&"object"==typeof define.amd&&define.amd;o?define(j):n?j(a,b.exports,b):i(c)}()},{"../format":13,"./core":24,"./fake_xdomain_request":29,"./fake_xml_http_request":30}],27:[function(a,b){"use strict";!function(){function c(a){function b(){}b.prototype=a.fakeServer,a.fakeServerWithClock=new b,a.fakeServerWithClock.addRequest=function(b){if(b.async&&("object"==typeof setTimeout.clock?this.clock=setTimeout.clock:(this.clock=a.useFakeTimers(),this.resetClock=!0),!this.longestTimeout)){var c=this.clock.setTimeout,d=this.clock.setInterval,e=this;this.clock.setTimeout=function(a,b){return e.longestTimeout=Math.max(b,e.longestTimeout||0),c.apply(this,arguments)},this.clock.setInterval=function(a,b){return e.longestTimeout=Math.max(b,e.longestTimeout||0),d.apply(this,arguments)}}return a.fakeServer.addRequest.call(this,b)},a.fakeServerWithClock.respond=function(){var b=a.fakeServer.respond.apply(this,arguments);return this.clock&&(this.clock.tick(this.longestTimeout||0),this.longestTimeout=0,this.resetClock&&(this.clock.restore(),this.resetClock=!1)),b},a.fakeServerWithClock.restore=function(){return this.clock&&this.clock.restore(),a.fakeServer.restore.apply(this,arguments)}}function d(a){var b=a("./core");a("./fake_server"),a("./fake_timers"),c(b)}var e="undefined"!=typeof b&&b.exports&&"function"==typeof a,f="function"==typeof define&&"object"==typeof define.amd&&define.amd;f?define(d):e?d(a):c(sinon)}()},{"./core":24,"./fake_server":26,"./fake_timers":28}],28:[function(a,b){(function(c){"use strict";if("undefined"==typeof d)var d={};!function(){function c(a,b){var c="undefined"!=typeof lolex?lolex:b;a.useFakeTimers=function(){var a,b=Array.prototype.slice.call(arguments);a="string"==typeof b[0]?0:b.shift();var d=c.install(a||0,b);return d.restore=d.uninstall,d},a.clock={create:function(a){return c.createClock(a)}},a.timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setImmediate:"undefined"!=typeof setImmediate?setImmediate:void 0,clearImmediate:"undefined"!=typeof clearImmediate?clearImmediate:void 0,setInterval:setInterval,clearInterval:clearInterval,Date:Date}}function e(a,b,d,e){var f=a("./core");c(f,e),d.exports=f}var f="undefined"!=typeof b&&b.exports&&"function"==typeof a,g="function"==typeof define&&"object"==typeof define.amd&&define.amd;g?define(e):f?e(a,b.exports,b,a("lolex")):c(d)}("undefined"!=typeof c&&"function"!=typeof c?c:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./core":24,lolex:33}],29:[function(a,b){"use strict";"undefined"==typeof sinon&&(this.sinon={}),function(c){function d(a){function b(){this.readyState=b.UNSENT,this.requestBody=null,this.requestHeaders={},this.status=0,this.timeout=null,"function"==typeof b.onCreate&&b.onCreate(this)}function d(a){if(a.readyState!==b.OPENED)throw new Error("INVALID_STATE_ERR");if(a.sendFlag)throw new Error("INVALID_STATE_ERR")}function e(a){if(a.readyState==b.UNSENT)throw new Error("Request not sent");if(a.readyState==b.DONE)throw new Error("Request done")}function g(a){if("string"!=typeof a){var b=new Error("Attempted to respond to fake XDomainRequest with "+a+", which is not a string.");throw b.name="InvalidBodyException",b}}a.xdr=f,a.extend(b.prototype,a.EventTarget,{open:function(a,c){this.method=a,this.url=c,this.responseText=null,this.sendFlag=!1,this.readyStateChange(b.OPENED)},readyStateChange:function(c){this.readyState=c;
var d="";switch(this.readyState){case b.UNSENT:break;case b.OPENED:break;case b.LOADING:this.sendFlag&&(d="onprogress");break;case b.DONE:d=this.isTimeout?"ontimeout":this.errorFlag||this.status<200||this.status>299?"onerror":"onload"}if(d&&"function"==typeof this[d])try{this[d]()}catch(e){a.logError("Fake XHR "+d+" handler",e)}},send:function(a){d(this),/^(get|head)$/i.test(this.method)||(this.requestBody=a),this.requestHeaders["Content-Type"]="text/plain;charset=utf-8",this.errorFlag=!1,this.sendFlag=!0,this.readyStateChange(b.OPENED),"function"==typeof this.onSend&&this.onSend(this)},abort:function(){this.aborted=!0,this.responseText=null,this.errorFlag=!0,this.readyState>a.FakeXDomainRequest.UNSENT&&this.sendFlag&&(this.readyStateChange(a.FakeXDomainRequest.DONE),this.sendFlag=!1)},setResponseBody:function(a){e(this),g(a);var c=this.chunkSize||10,d=0;this.responseText="";do this.readyStateChange(b.LOADING),this.responseText+=a.substring(d,d+c),d+=c;while(d<a.length);this.readyStateChange(b.DONE)},respond:function(a,b,c){this.status="number"==typeof a?a:200,this.setResponseBody(c||"")},simulatetimeout:function(){this.status=0,this.isTimeout=!0,this.responseText=void 0,this.readyStateChange(b.DONE)}}),a.extend(b,{UNSENT:0,OPENED:1,LOADING:3,DONE:4}),a.useFakeXDomainRequest=function(){return a.FakeXDomainRequest.restore=function(b){f.supportsXDR&&(c.XDomainRequest=f.GlobalXDomainRequest),delete a.FakeXDomainRequest.restore,b!==!0&&delete a.FakeXDomainRequest.onCreate},f.supportsXDR&&(c.XDomainRequest=a.FakeXDomainRequest),a.FakeXDomainRequest},a.FakeXDomainRequest=b}function e(a,b,c){var e=a("./core");a("../extend"),a("./event"),a("../log_error"),d(e),c.exports=e}var f={XDomainRequest:c.XDomainRequest};f.GlobalXDomainRequest=c.XDomainRequest,f.supportsXDR="undefined"!=typeof f.GlobalXDomainRequest,f.workingXDR=f.supportsXDR?f.GlobalXDomainRequest:!1;var g="undefined"!=typeof b&&b.exports&&"function"==typeof a,h="function"==typeof define&&"object"==typeof define.amd&&define.amd;h?define(e):g?e(a,b.exports,b):d(sinon)}(this)},{"../extend":12,"../log_error":14,"./core":24,"./event":25}],30:[function(a,b){(function(c){"use strict";!function(c){function d(){function a(a){b.addEventListener(a,function(c){var d=b["on"+a];d&&"function"==typeof d&&d.call(this,c)})}this.readyState=d.UNSENT,this.requestHeaders={},this.requestBody=null,this.status=0,this.statusText="",this.upload=new e,r.supportsCORS&&(this.withCredentials=!1);for(var b=this,c=["loadstart","load","abort","loadend"],f=c.length-1;f>=0;f--)a(c[f]);"function"==typeof d.onCreate&&d.onCreate(this)}function e(){this.eventListeners={progress:[],load:[],abort:[],error:[]}}function f(a){if(a.readyState!==d.OPENED)throw new Error("INVALID_STATE_ERR");if(a.sendFlag)throw new Error("INVALID_STATE_ERR")}function g(a,b){b=b.toLowerCase();for(var c in a)if(c.toLowerCase()==b)return c;return null}function h(a,b){if(a)for(var c=0,d=a.length;d>c;c+=1)b(a[c])}function i(a,b){for(var c=0;c<a.length;c++)if(b(a[c])===!0)return!0;return!1}function j(a){if(a.readyState!=d.OPENED)throw new Error("INVALID_STATE_ERR - "+a.readyState)}function k(a){if(a.readyState==d.DONE)throw new Error("Request done")}function l(a){if(a.async&&a.readyState!=d.HEADERS_RECEIVED)throw new Error("No headers received")}function m(a){if("string"!=typeof a){var b=new Error("Attempted to respond to fake XMLHttpRequest with "+a+", which is not a string.");throw b.name="InvalidBodyException",b}}function n(a){a.xhr=r,a.extend(d.prototype,a.EventTarget,{async:!0,open:function(a,b,c,e,f){if(this.method=a,this.url=b,this.async="boolean"==typeof c?c:!0,this.username=e,this.password=f,this.responseText=null,this.responseXML=null,this.requestHeaders={},this.sendFlag=!1,d.useFilters===!0){var g=arguments,h=i(d.filters,function(a){return a.apply(this,g)});if(h)return d.defake(this,arguments)}this.readyStateChange(d.OPENED)},readyStateChange:function(b){if(this.readyState=b,"function"==typeof this.onreadystatechange)try{this.onreadystatechange()}catch(c){a.logError("Fake XHR onreadystatechange handler",c)}switch(this.dispatchEvent(new a.Event("readystatechange")),this.readyState){case d.DONE:this.dispatchEvent(new a.Event("load",!1,!1,this)),this.dispatchEvent(new a.Event("loadend",!1,!1,this)),this.upload.dispatchEvent(new a.Event("load",!1,!1,this)),p&&(this.upload.dispatchEvent(new a.ProgressEvent("progress",{loaded:100,total:100})),this.dispatchEvent(new a.ProgressEvent("progress",{loaded:100,total:100})))}},setRequestHeader:function(a,b){if(f(this),s[a]||/^(Sec-|Proxy-)/.test(a))throw new Error('Refused to set unsafe header "'+a+'"');this.requestHeaders[a]?this.requestHeaders[a]+=","+b:this.requestHeaders[a]=b},setResponseHeaders:function(a){j(this),this.responseHeaders={};for(var b in a)a.hasOwnProperty(b)&&(this.responseHeaders[b]=a[b]);this.async?this.readyStateChange(d.HEADERS_RECEIVED):this.readyState=d.HEADERS_RECEIVED},send:function(b){if(f(this),!/^(get|head)$/i.test(this.method)){var c=g(this.requestHeaders,"Content-Type");if(this.requestHeaders[c]){var e=this.requestHeaders[c].split(";");this.requestHeaders[c]=e[0]+";charset=utf-8"}else b instanceof FormData||(this.requestHeaders["Content-Type"]="text/plain;charset=utf-8");this.requestBody=b}this.errorFlag=!1,this.sendFlag=this.async,this.readyStateChange(d.OPENED),"function"==typeof this.onSend&&this.onSend(this),this.dispatchEvent(new a.Event("loadstart",!1,!1,this))},abort:function(){this.aborted=!0,this.responseText=null,this.errorFlag=!0,this.requestHeaders={},this.readyState>d.UNSENT&&this.sendFlag&&(this.readyStateChange(d.DONE),this.sendFlag=!1),this.readyState=d.UNSENT,this.dispatchEvent(new a.Event("abort",!1,!1,this)),this.upload.dispatchEvent(new a.Event("abort",!1,!1,this)),"function"==typeof this.onerror&&this.onerror()},getResponseHeader:function(a){return this.readyState<d.HEADERS_RECEIVED?null:/^Set-Cookie2?$/i.test(a)?null:(a=g(this.responseHeaders,a),this.responseHeaders[a]||null)},getAllResponseHeaders:function(){if(this.readyState<d.HEADERS_RECEIVED)return"";var a="";for(var b in this.responseHeaders)this.responseHeaders.hasOwnProperty(b)&&!/^Set-Cookie2?$/i.test(b)&&(a+=b+": "+this.responseHeaders[b]+"\r\n");return a},setResponseBody:function(a){k(this),l(this),m(a);var b=this.chunkSize||10,c=0;this.responseText="";do this.async&&this.readyStateChange(d.LOADING),this.responseText+=a.substring(c,c+b),c+=b;while(c<a.length);var e=this.getResponseHeader("Content-Type");if(this.responseText&&(!e||/(text\/xml)|(application\/xml)|(\+xml)/.test(e)))try{this.responseXML=d.parseXML(this.responseText)}catch(f){}this.readyStateChange(d.DONE)},respond:function(a,b,c){this.status="number"==typeof a?a:200,this.statusText=d.statusCodes[this.status],this.setResponseHeaders(b||{}),this.setResponseBody(c||"")},uploadProgress:function(b){p&&this.upload.dispatchEvent(new a.ProgressEvent("progress",b))},downloadProgress:function(b){p&&this.dispatchEvent(new a.ProgressEvent("progress",b))},uploadError:function(b){q&&this.upload.dispatchEvent(new a.CustomEvent("error",{detail:b}))}}),a.extend(d,{UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4}),a.useFakeXMLHttpRequest=function(){return d.restore=function(a){r.supportsXHR&&(c.XMLHttpRequest=r.GlobalXMLHttpRequest),r.supportsActiveX&&(c.ActiveXObject=r.GlobalActiveXObject),delete d.restore,a!==!0&&delete d.onCreate},r.supportsXHR&&(c.XMLHttpRequest=d),r.supportsActiveX&&(c.ActiveXObject=function(a){return"Microsoft.XMLHTTP"==a||/^Msxml2\.XMLHTTP/i.test(a)?new d:new r.GlobalActiveXObject(a)}),d},a.FakeXMLHttpRequest=d}function o(a,b,c){var d=a("./core");a("../extend"),a("./event"),a("../log_error"),n(d),c.exports=d}var p="undefined"!=typeof ProgressEvent,q="undefined"!=typeof CustomEvent,r={XMLHttpRequest:c.XMLHttpRequest};r.GlobalXMLHttpRequest=c.XMLHttpRequest,r.GlobalActiveXObject=c.ActiveXObject,r.supportsActiveX="undefined"!=typeof r.GlobalActiveXObject,r.supportsXHR="undefined"!=typeof r.GlobalXMLHttpRequest,r.workingXHR=r.supportsXHR?r.GlobalXMLHttpRequest:r.supportsActiveX?function(){return new r.GlobalActiveXObject("MSXML2.XMLHTTP.3.0")}:!1,r.supportsCORS=r.supportsXHR&&"withCredentials"in new r.GlobalXMLHttpRequest;var s={"Accept-Charset":!0,"Accept-Encoding":!0,Connection:!0,"Content-Length":!0,Cookie:!0,Cookie2:!0,"Content-Transfer-Encoding":!0,Date:!0,Expect:!0,Host:!0,"Keep-Alive":!0,Referer:!0,TE:!0,Trailer:!0,"Transfer-Encoding":!0,Upgrade:!0,"User-Agent":!0,Via:!0};e.prototype.addEventListener=function(a,b){this.eventListeners[a].push(b)},e.prototype.removeEventListener=function(a,b){for(var c=this.eventListeners[a]||[],d=0,e=c.length;e>d;++d)if(c[d]==b)return c.splice(d,1)},e.prototype.dispatchEvent=function(a){for(var b,c=this.eventListeners[a.type]||[],d=0;null!=(b=c[d]);d++)b(a)};var t=function(a,b,c){switch(c.length){case 0:return a[b]();case 1:return a[b](c[0]);case 2:return a[b](c[0],c[1]);case 3:return a[b](c[0],c[1],c[2]);case 4:return a[b](c[0],c[1],c[2],c[3]);case 5:return a[b](c[0],c[1],c[2],c[3],c[4])}};d.filters=[],d.addFilter=function(a){this.filters.push(a)};var u=/MSIE 6/;d.defake=function(a,b){var c=new r.workingXHR;h(["open","setRequestHeader","send","abort","getResponseHeader","getAllResponseHeaders","addEventListener","overrideMimeType","removeEventListener"],function(b){a[b]=function(){return t(c,b,arguments)}});var e=function(b){h(b,function(b){try{a[b]=c[b]}catch(d){if(!u.test(navigator.userAgent))throw d}})},f=function(){a.readyState=c.readyState,c.readyState>=d.HEADERS_RECEIVED&&e(["status","statusText"]),c.readyState>=d.LOADING&&e(["responseText","response"]),c.readyState===d.DONE&&e(["responseXML"]),a.onreadystatechange&&a.onreadystatechange.call(a,{target:a})};if(c.addEventListener){for(var g in a.eventListeners)a.eventListeners.hasOwnProperty(g)&&h(a.eventListeners[g],function(a){c.addEventListener(g,a)});c.addEventListener("readystatechange",f)}else c.onreadystatechange=f;t(c,"open",b)},d.useFilters=!1,d.parseXML=function(a){var b;if("undefined"!=typeof DOMParser){var c=new DOMParser;b=c.parseFromString(a,"text/xml")}else b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a);return b},d.statusCodes={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};var v="undefined"!=typeof b&&b.exports&&"function"==typeof a,w="function"==typeof define&&"object"==typeof define.amd&&define.amd;if(w)define(o);else if(v)o(a,b.exports,b);else{if("undefined"==typeof sinon)return;n(sinon)}}("undefined"!=typeof c?c:this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../extend":12,"../log_error":14,"./core":24,"./event":25}],31:[function(a,b){(function(c){("function"==typeof define&&define.amd&&function(a){define("formatio",["samsam"],a)}||"object"==typeof b&&function(c){b.exports=c(a("samsam"))}||function(a){this.formatio=a(this.samsam)})(function(a){"use strict";function b(a){if(!a)return"";if(a.displayName)return a.displayName;if(a.name)return a.name;var b=a.toString().match(/function\s+([^\(]+)/m);return b&&b[1]||""}function d(a,c){var d,e,f=b(c&&c.constructor),g=a.excludeConstructors||h.excludeConstructors||[];for(d=0,e=g.length;e>d;++d){if("string"==typeof g[d]&&g[d]===f)return"";if(g[d].test&&g[d].test(f))return""}return f}function e(a,b){if("object"!=typeof a)return!1;var c,d;for(c=0,d=b.length;d>c;++c)if(b[c]===a)return!0;return!1}function f(b,c,d,g){if("string"==typeof c){var h=b.quoteStrings,j="boolean"!=typeof h||h;return d||j?'"'+c+'"':c}if("function"==typeof c&&!(c instanceof RegExp))return f.func(c);if(d=d||[],e(c,d))return"[Circular]";if("[object Array]"===Object.prototype.toString.call(c))return f.array.call(b,c,d);if(!c)return String(1/c===-1/0?"-0":c);if(a.isElement(c))return f.element(c);if("function"==typeof c.toString&&c.toString!==Object.prototype.toString)return c.toString();var k,l;for(k=0,l=i.length;l>k;k++)if(c===i[k].object)return i[k].value;return f.object.call(b,c,d,g)}function g(a){for(var b in a)this[b]=a[b]}var h={excludeConstructors:["Object",/^.$/],quoteStrings:!0,limitChildrenCount:0},i=(Object.prototype.hasOwnProperty,[]);return"undefined"!=typeof c&&i.push({object:c,value:"[object global]"}),"undefined"!=typeof document&&i.push({object:document,value:"[object HTMLDocument]"}),"undefined"!=typeof window&&i.push({object:window,value:"[object Window]"}),f.func=function(a){return"function "+b(a)+"() {}"},f.array=function(a,b){b=b||[],b.push(a);var c,d,e=[];for(d=this.limitChildrenCount>0?Math.min(this.limitChildrenCount,a.length):a.length,c=0;d>c;++c)e.push(f(this,a[c],b));return d<a.length&&e.push("[... "+(a.length-d)+" more elements]"),"["+e.join(", ")+"]"},f.object=function(b,c,g){c=c||[],c.push(b),g=g||0;var h,i,j,k,l,m,n=[],o=a.keys(b).sort(),p=3;for(m=this.limitChildrenCount>0?Math.min(this.limitChildrenCount,o.length):o.length,k=0;m>k;++k)h=o[k],j=b[h],i=e(j,c)?"[Circular]":f(this,j,c,g+2),i=(/\s/.test(h)?'"'+h+'"':h)+": "+i,p+=i.length,n.push(i);var q=d(this,b),r=q?"["+q+"] ":"",s="";for(k=0,l=g;l>k;++k)s+=" ";return m<o.length&&n.push("[... "+(o.length-m)+" more elements]"),p+g>80?r+"{\n  "+s+n.join(",\n  "+s)+"\n"+s+"}":r+"{ "+n.join(", ")+" }"},f.element=function(a){var b,c,d,e,f,g=a.tagName.toLowerCase(),h=a.attributes,i=[];for(d=0,e=h.length;e>d;++d)b=h.item(d),c=b.nodeName.toLowerCase().replace("html:",""),f=b.nodeValue,("contenteditable"!==c||"inherit"!==f)&&f&&i.push(c+'="'+f+'"');var j="<"+g+(i.length>0?" ":""),k=a.innerHTML;k.length>20&&(k=k.substr(0,20)+"[...]");var l=j+i.join(" ")+">"+k+"</"+g+">";return l.replace(/ contentEditable="inherit"/,"")},g.prototype={functionName:b,configure:function(a){return new g(a)},constructorName:function(a){return d(this,a)},ascii:function(a,b,c){return f(this,a,b,c)}},g.prototype})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{samsam:32}],32:[function(a,b){("function"==typeof define&&define.amd&&function(a){define("samsam",a)}||"object"==typeof b&&function(a){b.exports=a()}||function(a){this.samsam=a()})(function(){function a(a){var b=a;return"number"==typeof a&&a!==b}function b(a){return l.toString.call(a).split(/[ \]]/)[1]}function c(a){if("Arguments"===b(a))return!0;if("object"!=typeof a||"number"!=typeof a.length||"Array"===b(a))return!1;if("function"==typeof a.callee)return!0;try{a[a.length]=6,delete a[a.length]}catch(c){return!0}return!1}function d(a){if(!a||1!==a.nodeType||!m)return!1;try{a.appendChild(m),a.removeChild(m)}catch(b){return!1}return!0}function e(a){var b,c=[];for(b in a)l.hasOwnProperty.call(a,b)&&c.push(b);return c}function f(a){return"function"==typeof a.getTime&&a.getTime()==a.valueOf()}function g(a){return 0===a&&1/a===-1/0}function h(b,c){return b===c||a(b)&&a(c)?0!==b||g(b)===g(c):void 0}function i(g,i){function j(a){return"object"!=typeof a||null===a||a instanceof Boolean||a instanceof Date||a instanceof Number||a instanceof RegExp||a instanceof String?!1:!0}function k(a,b){var c;for(c=0;c<a.length;c++)if(a[c]===b)return c;return-1}var m=[],n=[],o=[],p=[],q={};return function r(g,i,s,t){var u=typeof g,v=typeof i;if(g===i||a(g)||a(i)||null==g||null==i||"object"!==u||"object"!==v)return h(g,i);if(d(g)||d(i))return!1;var w=f(g),x=f(i);if(!(!w&&!x||w&&x&&g.getTime()===i.getTime()))return!1;if(g instanceof RegExp&&i instanceof RegExp&&g.toString()!==i.toString())return!1;var y=b(g),z=b(i),A=e(g),B=e(i);if(c(g)||c(i)){if(g.length!==i.length)return!1}else if(u!==v||y!==z||A.length!==B.length)return!1;var C,D,E,F,G,H,I,J,K,L,M;for(D=0,E=A.length;E>D;D++){if(C=A[D],!l.hasOwnProperty.call(i,C))return!1;if(F=g[C],G=i[C],H=j(F),I=j(G),J=H?k(m,F):-1,K=I?k(n,G):-1,L=-1!==J?o[J]:s+"["+JSON.stringify(C)+"]",M=-1!==K?p[K]:t+"["+JSON.stringify(C)+"]",q[L+M])return!0;if(-1===J&&H&&(m.push(F),o.push(L)),-1===K&&I&&(n.push(G),p.push(M)),H&&I&&(q[L+M]=!0),!r(F,G,L,M))return!1}return!0}(g,i,"$1","$2")}function j(a,b){if(0===b.length)return!0;var c,d,e,f;for(c=0,d=a.length;d>c;++c)if(k(a[c],b[0])){for(e=0,f=b.length;f>e;++e)if(!k(a[c+e],b[e]))return!1;return!0}return!1}var k,l=Object.prototype,m="undefined"!=typeof document&&document.createElement("div");return k=function n(a,c){if(c&&"function"==typeof c.test)return c.test(a);if("function"==typeof c)return c(a)===!0;if("string"==typeof c){c=c.toLowerCase();var d="string"==typeof a||!!a;return d&&String(a).toLowerCase().indexOf(c)>=0}if("number"==typeof c)return c===a;if("boolean"==typeof c)return c===a;if("undefined"==typeof c)return"undefined"==typeof a;if(null===c)return null===a;if("Array"===b(a)&&"Array"===b(c))return j(a,c);if(c&&"object"==typeof c){if(c===a)return!0;var e;for(e in c){var f=a[e];if("undefined"==typeof f&&"function"==typeof a.getAttribute&&(f=a.getAttribute(e)),null===c[e]||"undefined"==typeof c[e]){if(f!==c[e])return!1}else if("undefined"==typeof f||!n(f,c[e]))return!1}return!0}throw new Error("Matcher was not a string, a number, a function, a boolean or an object")},{isArguments:c,isElement:d,isDate:f,isNegZero:g,identical:h,deepEqual:i,match:k,keys:e}})},{}],33:[function(require,module,exports){(function(global){"use strict";function parseTime(a){if(!a)return 0;var b,c=a.split(":"),d=c.length,e=d,f=0;if(d>3||!/^(\d\d:){0,2}\d\d?$/.test(a))throw new Error("tick only understands numbers and 'h:m:s'");for(;e--;){if(b=parseInt(c[e],10),b>=60)throw new Error("Invalid time "+a);f+=b*Math.pow(60,d-e-1)}return 1e3*f}function getEpoch(a){if(!a)return 0;if("function"==typeof a.getTime)return a.getTime();if("number"==typeof a)return a;throw new TypeError("now should be milliseconds since UNIX epoch")}function inRange(a,b,c){return c&&c.callAt>=a&&c.callAt<=b}function mirrorDateProperties(a,b){b.now?a.now=function(){return a.clock.now}:delete a.now,b.toSource?a.toSource=function(){return b.toSource()}:delete a.toSource,a.toString=function(){return b.toString()},a.prototype=b.prototype,a.parse=b.parse,a.UTC=b.UTC,a.prototype.toUTCString=b.prototype.toUTCString;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function createDate(){function a(b,c,d,e,f,g,h){switch(arguments.length){case 0:return new NativeDate(a.clock.now);case 1:return new NativeDate(b);case 2:return new NativeDate(b,c);case 3:return new NativeDate(b,c,d);case 4:return new NativeDate(b,c,d,e);case 5:return new NativeDate(b,c,d,e,f);case 6:return new NativeDate(b,c,d,e,f,g);default:return new NativeDate(b,c,d,e,f,g,h)}}return mirrorDateProperties(a,NativeDate)}function addTimer(a,b){if("undefined"==typeof b.func)throw new Error("Callback must be provided to timer calls");return a.timers||(a.timers={}),b.id=id++,b.createdAt=a.now,b.callAt=a.now+(b.delay||0),a.timers[b.id]=b,addTimerReturnsObject?{id:b.id,ref:function(){},unref:function(){}}:b.id}function firstTimerInRange(a,b,c){var d=a.timers,e=null;for(var f in d)inRange(b,c,d[f])&&(!e||~compareTimers(e,d[f]))&&(e=d[f]);return e}function compareTimers(a,b){return a.callAt<b.callAt?-1:a.callAt>b.callAt?1:a.immediate&&!b.immediate?-1:!a.immediate&&b.immediate?1:a.createdAt<b.createdAt?-1:a.createdAt>b.createdAt?1:a.id<b.id?-1:a.id>b.id?1:void 0}function callTimer(clock,timer){"number"==typeof timer.interval?clock.timers[timer.id].callAt+=timer.interval:delete clock.timers[timer.id];try{"function"==typeof timer.func?timer.func.apply(null,timer.args):eval(timer.func)}catch(e){var exception=e}if(clock.timers[timer.id]){if(exception)throw exception}else if(exception)throw exception}function uninstall(a,b){for(var c,d=0,e=a.methods.length;e>d;d++)if(c=a.methods[d],b[c].hadOwnProperty)b[c]=a["_"+c];else try{delete b[c]}catch(f){}a.methods=[]}function hijackMethod(a,b,c){if(c[b].hadOwnProperty=Object.prototype.hasOwnProperty.call(a,b),c["_"+b]=a[b],"Date"==b){var d=mirrorDateProperties(c[b],a[b]);a[b]=d}else{a[b]=function(){return c[b].apply(c,arguments)};for(var e in c[b])c[b].hasOwnProperty(e)&&(a[b][e]=c[b][e])}a[b].clock=c}var timeoutResult=setTimeout(function(){},0),addTimerReturnsObject="object"==typeof timeoutResult;clearTimeout(timeoutResult);var NativeDate=Date,id=1,timers={setTimeout:setTimeout,clearTimeout:clearTimeout,setImmediate:"undefined"!=typeof setImmediate?setImmediate:void 0,clearImmediate:"undefined"!=typeof clearImmediate?clearImmediate:void 0,setInterval:setInterval,clearInterval:clearInterval,Date:Date},keys=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b};exports.timers=timers;var createClock=exports.createClock=function(a){var b={now:getEpoch(a),timeouts:{},Date:createDate()};return b.Date.clock=b,b.setTimeout=function(a,c){return addTimer(b,{func:a,args:Array.prototype.slice.call(arguments,2),delay:c})},b.clearTimeout=function(a){a&&(b.timers||(b.timers=[]),"object"==typeof a&&(a=a.id),a in b.timers&&delete b.timers[a])},b.setInterval=function(a,c){return addTimer(b,{func:a,args:Array.prototype.slice.call(arguments,2),delay:c,interval:c})},b.clearInterval=function(a){b.clearTimeout(a)},b.setImmediate=function(a){return addTimer(b,{func:a,args:Array.prototype.slice.call(arguments,1),immediate:!0})},b.clearImmediate=function(a){b.clearTimeout(a)},b.tick=function(a){a="number"==typeof a?a:parseTime(a);for(var c,d=b.now,e=b.now+a,f=b.now,g=firstTimerInRange(b,d,e);g&&e>=d;){if(b.timers[g.id]){d=b.now=g.callAt;try{callTimer(b,g)}catch(h){c=c||h}}g=firstTimerInRange(b,f,e),f=d}if(b.now=e,c)throw c;return b.now},b.reset=function(){b.timers={}},b};exports.install=function(a,b,c){"number"==typeof a&&(c=b,b=a,a=null),a||(a=global);var d=createClock(b);d.uninstall=function(){uninstall(d,a)},d.methods=c||[],0===d.methods.length&&(d.methods=keys(timers));for(var e=0,f=d.methods.length;f>e;e++)hijackMethod(a,d.methods[e],d);return d}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[1,2]);